# -*- coding: utf-8 -*-
"""
@Author: lamborghini1993
@Date: 2019-09-11 15:13:37
@Description:

process_request-request:
    COOKIES : {'csrftoken': 'ylVkV5ejuEEwKVcDxQlmebMiPnfuCGFEZcSob7LR4wX2DJzDaEFcc97L2MKLSKW1', 'sessionid': 'p5be6dia5gjztg1ylsi8634dps65mwhh'}
    FILES : <MultiValueDict: {}>
    GET : <QueryDict: {}>
    META : {'PATH': '/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'LC_MEASUREMENT': 'zh_CN.UTF-8', 'XAUTHORITY': '/run/user/1000/gdm/Xauthority', 'XMODIFIERS': '@im=fcitx', 'LC_TELEPHONE': 'zh_CN.UTF-8', 'XDG_DATA_DIRS': '/usr/share/ubuntu:/usr/local/share/:/usr/share/:/var/lib/snapd/desktop:/var/lib/snapd/desktop', 'GDMSESSION': 'ubuntu', 'MANDATORY_PATH': '/usr/share/gconf/ubuntu.mandatory.path', 'LC_TIME': 'zh_CN.UTF-8', 'PAPERSIZE': 'a4', 'TEXTDOMAINDIR': '/usr/share/locale/', 'GTK_IM_MODULE': 'fcitx', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/1000/bus', 'DEFAULTS_PATH': '/usr/share/gconf/ubuntu.default.path', 'XDG_CURRENT_DESKTOP': 'ubuntu:GNOME', 'SSH_AGENT_PID': '2770', 'QT4_IM_MODULE': 'fcitx', 'LC_PAPER': 'zh_CN.UTF-8', 'SESSION_MANAGER': 'local/lamborghini:@/tmp/.ICE-unix/2671,unix/lamborghini:/tmp/.ICE-unix/2671', 'USERNAME': 'love', 'LOGNAME': 'love', 'PWD': '/home/love/mygit/MyCode/project/learn_django', 'IM_CONFIG_PHASE': '2', 'PYCHARM_HOSTED': '1', 'LANGUAGE': 'zh_CN:en', 'GJS_DEBUG_TOPICS': 'JS ERROR;JS LOG', 'PYTHONPATH': '/home/love/mygit/MyCode/project/learn_django:/opt/pycharm-2019.2.1/helpers/pycharm_matplotlib_backend:/opt/pycharm-2019.2.1/helpers/pycharm_display', 'SHELL': '/bin/zsh', 'LC_ADDRESS': 'zh_CN.UTF-8', 'GIO_LAUNCHED_DESKTOP_FILE': '/usr/share/applications/jetbrains-pycharm.desktop', 'OLDPWD': '/opt/pycharm-2019.2.1/bin', 'GNOME_DESKTOP_SESSION_ID': 'this-is-deprecated', 'GTK_MODULES': 'gail:atk-bridge', 'CLUTTER_IM_MODULE': 'xim', 'TEXTDOMAIN': 'im-config', 'XDG_SESSION_DESKTOP': 'ubuntu', 'SHLVL': '0', 'LC_IDENTIFICATION': 'zh_CN.UTF-8', 'LC_MONETARY': 'zh_CN.UTF-8', 'QT_IM_MODULE': 'fcitx', 'XDG_CONFIG_DIRS': '/etc/xdg/xdg-ubuntu:/etc/xdg', 'LANG': 'zh_CN.UTF-8', 'XDG_SESSION_ID': '2', 'XDG_SESSION_TYPE': 'x11', 'DISPLAY': ':0', 'LC_NAME': 'zh_CN.UTF-8', 'PYCHARM_DISPLAY_PORT': '63342', 'PYTHONIOENCODING': 'UTF-8', 'GPG_AGENT_INFO': '/run/user/1000/gnupg/S.gpg-agent:0:1', 'DESKTOP_SESSION': 'ubuntu', 'USER': 'love', 'XDG_MENU_PREFIX': 'gnome-', 'GIO_LAUNCHED_DESKTOP_FILE_PID': '8776', 'QT_ACCESSIBILITY': '1', 'WINDOWPATH': '2', 'LC_NUMERIC': 'zh_CN.UTF-8', 'GJS_DEBUG_OUTPUT': 'stderr', 'SSH_AUTH_SOCK': '/run/user/1000/keyring/ssh', 'XDG_SEAT': 'seat0', 'DJANGO_SETTINGS_MODULE': 'learn_django.settings', 'PYTHONUNBUFFERED': '1', 'GNOME_SHELL_SESSION_MODE': 'ubuntu', 'XDG_VTNR': '2', 'XDG_RUNTIME_DIR': '/run/user/1000', 'HOME': '/home/love', 'TZ': 'Asia/Shanghai', 'RUN_MAIN': 'true', 'SERVER_NAME': 'localhost', 'GATEWAY_INTERFACE': 'CGI/1.1', 'SERVER_PORT': '8000', 'REMOTE_HOST': '', 'CONTENT_LENGTH': '', 'SCRIPT_NAME': '', 'SERVER_PROTOCOL': 'HTTP/1.1', 'SERVER_SOFTWARE': 'WSGIServer/0.2', 'REQUEST_METHOD': 'GET', 'PATH_INFO': '/learn_middleware/static', 'QUERY_STRING': '', 'REMOTE_ADDR': '127.0.0.1', 'CONTENT_TYPE': 'text/plain', 'HTTP_HOST': '127.0.0.1:8000', 'HTTP_CONNECTION': 'keep-alive', 'HTTP_CACHE_CONTROL': 'max-age=0', 'HTTP_USER_AGENT': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36', 'HTTP_UPGRADE_INSECURE_REQUESTS': '1', 'HTTP_ACCEPT': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, br', 'HTTP_ACCEPT_LANGUAGE': 'zh-CN,zh;q=0.9,en;q=0.8,ru;q=0.7', 'HTTP_COOKIE': 'csrftoken=ylVkV5ejuEEwKVcDxQlmebMiPnfuCGFEZcSob7LR4wX2DJzDaEFcc97L2MKLSKW1; sessionid=p5be6dia5gjztg1ylsi8634dps65mwhh', 'wsgi.input': <django.core.handlers.wsgi.LimitedStream object at 0x7f528fd71f98>, 'wsgi.errors': <_io.TextIOWrapper name='<stderr>' mode='w' encoding='UTF-8'>, 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.url_scheme': 'http', 'wsgi.multithread': True, 'wsgi.multiprocess': False, 'wsgi.file_wrapper': <class 'wsgiref.util.FileWrapper'>}
    POST : <QueryDict: {}>
    _current_scheme_host : http://127.0.0.1:8000
    _encoding : None
    _get_full_path : <bound method HttpRequest._get_full_path of <WSGIRequest: GET '/learn_middleware/static'>>
    _get_post : <bound method WSGIRequest._get_post of <WSGIRequest: GET '/learn_middleware/static'>>
    _get_raw_host : <bound method HttpRequest._get_raw_host of <WSGIRequest: GET '/learn_middleware/static'>>
    _get_scheme : <bound method WSGIRequest._get_scheme of <WSGIRequest: GET '/learn_middleware/static'>>
    _initialize_handlers : <bound method HttpRequest._initialize_handlers of <WSGIRequest: GET '/learn_middleware/static'>>
    _load_post_and_files : <bound method HttpRequest._load_post_and_files of <WSGIRequest: GET '/learn_middleware/static'>>
    _mark_post_parse_error : <bound method HttpRequest._mark_post_parse_error of <WSGIRequest: GET '/learn_middleware/static'>>
    _read_started : False
    _set_post : <bound method WSGIRequest._set_post of <WSGIRequest: GET '/learn_middleware/static'>>
    _stream : <django.core.handlers.wsgi.LimitedStream object at 0x7f528fd71b00>
    _upload_handlers : []
    body : b''
    build_absolute_uri : <bound method HttpRequest.build_absolute_uri of <WSGIRequest: GET '/learn_middleware/static'>>
    close : <bound method HttpRequest.close of <WSGIRequest: GET '/learn_middleware/static'>>
    content_params : {}
    content_type : text/plain
    encoding : None
    environ : {'PATH': '/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin', 'LC_MEASUREMENT': 'zh_CN.UTF-8', 'XAUTHORITY': '/run/user/1000/gdm/Xauthority', 'XMODIFIERS': '@im=fcitx', 'LC_TELEPHONE': 'zh_CN.UTF-8', 'XDG_DATA_DIRS': '/usr/share/ubuntu:/usr/local/share/:/usr/share/:/var/lib/snapd/desktop:/var/lib/snapd/desktop', 'GDMSESSION': 'ubuntu', 'MANDATORY_PATH': '/usr/share/gconf/ubuntu.mandatory.path', 'LC_TIME': 'zh_CN.UTF-8', 'PAPERSIZE': 'a4', 'TEXTDOMAINDIR': '/usr/share/locale/', 'GTK_IM_MODULE': 'fcitx', 'DBUS_SESSION_BUS_ADDRESS': 'unix:path=/run/user/1000/bus', 'DEFAULTS_PATH': '/usr/share/gconf/ubuntu.default.path', 'XDG_CURRENT_DESKTOP': 'ubuntu:GNOME', 'SSH_AGENT_PID': '2770', 'QT4_IM_MODULE': 'fcitx', 'LC_PAPER': 'zh_CN.UTF-8', 'SESSION_MANAGER': 'local/lamborghini:@/tmp/.ICE-unix/2671,unix/lamborghini:/tmp/.ICE-unix/2671', 'USERNAME': 'love', 'LOGNAME': 'love', 'PWD': '/home/love/mygit/MyCode/project/learn_django', 'IM_CONFIG_PHASE': '2', 'PYCHARM_HOSTED': '1', 'LANGUAGE': 'zh_CN:en', 'GJS_DEBUG_TOPICS': 'JS ERROR;JS LOG', 'PYTHONPATH': '/home/love/mygit/MyCode/project/learn_django:/opt/pycharm-2019.2.1/helpers/pycharm_matplotlib_backend:/opt/pycharm-2019.2.1/helpers/pycharm_display', 'SHELL': '/bin/zsh', 'LC_ADDRESS': 'zh_CN.UTF-8', 'GIO_LAUNCHED_DESKTOP_FILE': '/usr/share/applications/jetbrains-pycharm.desktop', 'OLDPWD': '/opt/pycharm-2019.2.1/bin', 'GNOME_DESKTOP_SESSION_ID': 'this-is-deprecated', 'GTK_MODULES': 'gail:atk-bridge', 'CLUTTER_IM_MODULE': 'xim', 'TEXTDOMAIN': 'im-config', 'XDG_SESSION_DESKTOP': 'ubuntu', 'SHLVL': '0', 'LC_IDENTIFICATION': 'zh_CN.UTF-8', 'LC_MONETARY': 'zh_CN.UTF-8', 'QT_IM_MODULE': 'fcitx', 'XDG_CONFIG_DIRS': '/etc/xdg/xdg-ubuntu:/etc/xdg', 'LANG': 'zh_CN.UTF-8', 'XDG_SESSION_ID': '2', 'XDG_SESSION_TYPE': 'x11', 'DISPLAY': ':0', 'LC_NAME': 'zh_CN.UTF-8', 'PYCHARM_DISPLAY_PORT': '63342', 'PYTHONIOENCODING': 'UTF-8', 'GPG_AGENT_INFO': '/run/user/1000/gnupg/S.gpg-agent:0:1', 'DESKTOP_SESSION': 'ubuntu', 'USER': 'love', 'XDG_MENU_PREFIX': 'gnome-', 'GIO_LAUNCHED_DESKTOP_FILE_PID': '8776', 'QT_ACCESSIBILITY': '1', 'WINDOWPATH': '2', 'LC_NUMERIC': 'zh_CN.UTF-8', 'GJS_DEBUG_OUTPUT': 'stderr', 'SSH_AUTH_SOCK': '/run/user/1000/keyring/ssh', 'XDG_SEAT': 'seat0', 'DJANGO_SETTINGS_MODULE': 'learn_django.settings', 'PYTHONUNBUFFERED': '1', 'GNOME_SHELL_SESSION_MODE': 'ubuntu', 'XDG_VTNR': '2', 'XDG_RUNTIME_DIR': '/run/user/1000', 'HOME': '/home/love', 'TZ': 'Asia/Shanghai', 'RUN_MAIN': 'true', 'SERVER_NAME': 'localhost', 'GATEWAY_INTERFACE': 'CGI/1.1', 'SERVER_PORT': '8000', 'REMOTE_HOST': '', 'CONTENT_LENGTH': '', 'SCRIPT_NAME': '', 'SERVER_PROTOCOL': 'HTTP/1.1', 'SERVER_SOFTWARE': 'WSGIServer/0.2', 'REQUEST_METHOD': 'GET', 'PATH_INFO': '/learn_middleware/static', 'QUERY_STRING': '', 'REMOTE_ADDR': '127.0.0.1', 'CONTENT_TYPE': 'text/plain', 'HTTP_HOST': '127.0.0.1:8000', 'HTTP_CONNECTION': 'keep-alive', 'HTTP_CACHE_CONTROL': 'max-age=0', 'HTTP_USER_AGENT': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36', 'HTTP_UPGRADE_INSECURE_REQUESTS': '1', 'HTTP_ACCEPT': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate, br', 'HTTP_ACCEPT_LANGUAGE': 'zh-CN,zh;q=0.9,en;q=0.8,ru;q=0.7', 'HTTP_COOKIE': 'csrftoken=ylVkV5ejuEEwKVcDxQlmebMiPnfuCGFEZcSob7LR4wX2DJzDaEFcc97L2MKLSKW1; sessionid=p5be6dia5gjztg1ylsi8634dps65mwhh', 'wsgi.input': <django.core.handlers.wsgi.LimitedStream object at 0x7f528fd71f98>, 'wsgi.errors': <_io.TextIOWrapper name='<stderr>' mode='w' encoding='UTF-8'>, 'wsgi.version': (1, 0), 'wsgi.run_once': False, 'wsgi.url_scheme': 'http', 'wsgi.multithread': True, 'wsgi.multiprocess': False, 'wsgi.file_wrapper': <class 'wsgiref.util.FileWrapper'>}
    get_full_path : <bound method HttpRequest.get_full_path of <WSGIRequest: GET '/learn_middleware/static'>>
    get_full_path_info : <bound method HttpRequest.get_full_path_info of <WSGIRequest: GET '/learn_middleware/static'>>
    get_host : <bound method HttpRequest.get_host of <WSGIRequest: GET '/learn_middleware/static'>>
    get_port : <bound method HttpRequest.get_port of <WSGIRequest: GET '/learn_middleware/static'>>
    get_raw_uri : <bound method HttpRequest.get_raw_uri of <WSGIRequest: GET '/learn_middleware/static'>>
    get_signed_cookie : <bound method HttpRequest.get_signed_cookie of <WSGIRequest: GET '/learn_middleware/static'>>
    headers : {'Content-Length': '', 'Content-Type': 'text/plain', 'Host': '127.0.0.1:8000', 'Connection': 'keep-alive', 'Cache-Control': 'max-age=0', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36', 'Upgrade-Insecure-Requests': '1', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', 'Accept-Encoding': 'gzip, deflate, br', 'Accept-Language': 'zh-CN,zh;q=0.9,en;q=0.8,ru;q=0.7', 'Cookie': 'csrftoken=ylVkV5ejuEEwKVcDxQlmebMiPnfuCGFEZcSob7LR4wX2DJzDaEFcc97L2MKLSKW1; sessionid=p5be6dia5gjztg1ylsi8634dps65mwhh'}
    is_ajax : <bound method HttpRequest.is_ajax of <WSGIRequest: GET '/learn_middleware/static'>>
    is_secure : <bound method HttpRequest.is_secure of <WSGIRequest: GET '/learn_middleware/static'>>
    method : GET
    parse_file_upload : <bound method HttpRequest.parse_file_upload of <WSGIRequest: GET '/learn_middleware/static'>>
    path : /learn_middleware/static
    path_info : /learn_middleware/static
    read : <bound method HttpRequest.read of <WSGIRequest: GET '/learn_middleware/static'>>
    readline : <bound method HttpRequest.readline of <WSGIRequest: GET '/learn_middleware/static'>>
    readlines : <bound method HttpRequest.readlines of <WSGIRequest: GET '/learn_middleware/static'>>
    resolver_match : None
    scheme : http
    upload_handlers : [<django.core.files.uploadhandler.MemoryFileUploadHandler object at 0x7f528fd19320>, <django.core.files.uploadhandler.TemporaryFileUploadHandler object at 0x7f528fd193c8>]
    xreadlines : <bound method HttpRequest.xreadlines of <WSGIRequest: GET '/learn_middleware/static'>>

process_request-request.META
    PATH : /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
    LC_MEASUREMENT : zh_CN.UTF-8
    XAUTHORITY : /run/user/1000/gdm/Xauthority
    XMODIFIERS : @im=fcitx
    LC_TELEPHONE : zh_CN.UTF-8
    XDG_DATA_DIRS : /usr/share/ubuntu:/usr/local/share/:/usr/share/:/var/lib/snapd/desktop:/var/lib/snapd/desktop
    GDMSESSION : ubuntu
    MANDATORY_PATH : /usr/share/gconf/ubuntu.mandatory.path
    LC_TIME : zh_CN.UTF-8
    PAPERSIZE : a4
    TEXTDOMAINDIR : /usr/share/locale/
    GTK_IM_MODULE : fcitx
    DBUS_SESSION_BUS_ADDRESS : unix:path=/run/user/1000/bus
    DEFAULTS_PATH : /usr/share/gconf/ubuntu.default.path
    XDG_CURRENT_DESKTOP : ubuntu:GNOME
    SSH_AGENT_PID : 2770
    QT4_IM_MODULE : fcitx
    LC_PAPER : zh_CN.UTF-8
    SESSION_MANAGER : local/lamborghini:@/tmp/.ICE-unix/2671,unix/lamborghini:/tmp/.ICE-unix/2671
    USERNAME : love
    LOGNAME : love
    PWD : /home/love/mygit/MyCode/project/learn_django
    IM_CONFIG_PHASE : 2
    PYCHARM_HOSTED : 1
    LANGUAGE : zh_CN:en
    GJS_DEBUG_TOPICS : JS ERROR;JS LOG
    PYTHONPATH : /home/love/mygit/MyCode/project/learn_django:/opt/pycharm-2019.2.1/helpers/pycharm_matplotlib_backend:/opt/pycharm-2019.2.1/helpers/pycharm_display
    SHELL : /bin/zsh
    LC_ADDRESS : zh_CN.UTF-8
    GIO_LAUNCHED_DESKTOP_FILE : /usr/share/applications/jetbrains-pycharm.desktop
    OLDPWD : /opt/pycharm-2019.2.1/bin
    GNOME_DESKTOP_SESSION_ID : this-is-deprecated
    GTK_MODULES : gail:atk-bridge
    CLUTTER_IM_MODULE : xim
    TEXTDOMAIN : im-config
    XDG_SESSION_DESKTOP : ubuntu
    SHLVL : 0
    LC_IDENTIFICATION : zh_CN.UTF-8
    LC_MONETARY : zh_CN.UTF-8
    QT_IM_MODULE : fcitx
    XDG_CONFIG_DIRS : /etc/xdg/xdg-ubuntu:/etc/xdg
    LANG : zh_CN.UTF-8
    XDG_SESSION_ID : 2
    XDG_SESSION_TYPE : x11
    DISPLAY : :0
    LC_NAME : zh_CN.UTF-8
    PYCHARM_DISPLAY_PORT : 63342
    PYTHONIOENCODING : UTF-8
    GPG_AGENT_INFO : /run/user/1000/gnupg/S.gpg-agent:0:1
    DESKTOP_SESSION : ubuntu
    USER : love
    XDG_MENU_PREFIX : gnome-
    GIO_LAUNCHED_DESKTOP_FILE_PID : 8776
    QT_ACCESSIBILITY : 1
    WINDOWPATH : 2
    LC_NUMERIC : zh_CN.UTF-8
    GJS_DEBUG_OUTPUT : stderr
    SSH_AUTH_SOCK : /run/user/1000/keyring/ssh
    XDG_SEAT : seat0
    DJANGO_SETTINGS_MODULE : learn_django.settings
    PYTHONUNBUFFERED : 1
    GNOME_SHELL_SESSION_MODE : ubuntu
    XDG_VTNR : 2
    XDG_RUNTIME_DIR : /run/user/1000
    HOME : /home/love
    TZ : Asia/Shanghai
    RUN_MAIN : true
    SERVER_NAME : localhost
    GATEWAY_INTERFACE : CGI/1.1
    SERVER_PORT : 8000
    REMOTE_HOST :
    CONTENT_LENGTH :
    SCRIPT_NAME :
    SERVER_PROTOCOL : HTTP/1.1
    SERVER_SOFTWARE : WSGIServer/0.2
    REQUEST_METHOD : GET
    PATH_INFO : /learn_middleware/static
    QUERY_STRING :
    REMOTE_ADDR : 127.0.0.1
    CONTENT_TYPE : text/plain
    HTTP_HOST : 127.0.0.1:8000
    HTTP_CONNECTION : keep-alive
    HTTP_CACHE_CONTROL : max-age=0
    HTTP_USER_AGENT : Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36
    HTTP_UPGRADE_INSECURE_REQUESTS : 1
    HTTP_ACCEPT : text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
    HTTP_ACCEPT_ENCODING : gzip, deflate, br
    HTTP_ACCEPT_LANGUAGE : zh-CN,zh;q=0.9,en;q=0.8,ru;q=0.7
    HTTP_COOKIE : csrftoken=ylVkV5ejuEEwKVcDxQlmebMiPnfuCGFEZcSob7LR4wX2DJzDaEFcc97L2MKLSKW1; sessionid=p5be6dia5gjztg1ylsi8634dps65mwhh
    wsgi.input : <django.core.handlers.wsgi.LimitedStream object at 0x7f3c03b68ac8>
    wsgi.errors : <_io.TextIOWrapper name='<stderr>' mode='w' encoding='UTF-8'>
    wsgi.version : (1, 0)
    wsgi.run_once : False
    wsgi.url_scheme : http
    wsgi.multithread : True
    wsgi.multiprocess : False
    wsgi.file_wrapper : <class 'wsgiref.util.FileWrapper'>
"""
import time

from django.core.cache import cache
from django.http import HttpResponse
from django.utils.deprecation import MiddlewareMixin


class StaticMiddleware(MiddlewareMixin):
    # def get_response(self, request):
    #     print("get_response", request)

    # def process_response(self, request, response):
    #     print("process_response", request, response)

    def process_request(self, request):
        ip = request.META["REMOTE_ADDR"]
        if request.path == "/learn_middleware/static":
            print("IP:", ip)

        elif request.path == "/learn_middleware/anti_scrapy":
            # 反爬虫：一分钟只可以访问10次
            key = "%s_anti_scrapy" % ip
            lst = cache.get(key, [])
            while lst and lst[0] + 60 < time.time():
                lst.pop(0)
            if len(lst) >= 10:
                return HttpResponse("访问超过次数限制")
            lst.append(time.time())
            cache.set(key, lst, timeout=60)
